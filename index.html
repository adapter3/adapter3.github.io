<!DOCTYPE html>
<html>
<head>
  <meta charset="UTF-8">
  <title>Questions Viewer</title>
  <style>
    body { font-family: Arial; padding: 20px; line-height: 1.6; }
    pre { background: #f4f4f4; padding: 10px; white-space: pre-wrap; }
  </style>
</head>
<body>

<h2>Question Viewer</h2>
<div id="content">Loading...</div>

<script>
const data = {
"1": `Question 1: Analyzing a Sales Dataset in R
---------------------------------------------
df<-read.csv("sales_data-1.csv")
str(df)
summary(df$Price)
hist(df$Quantity)
boxplot(df$Quantity)

median_price <- median(df$Price, na.rm = TRUE)
df$Price[is.na(df$Price)] <- median_price

east_sales <- subset(df, Region == "East")
head(east_sales)

product_info <- data.frame(
  Product = c("Tablet", "Phone", "Monitor", "Laptop", "Headphones"),
  Category = c("Electronics", "Electronics", "Electronics", "Electronics", "Accessories")
)

merged_data <- merge(east_sales, product_info, by = "Product")
head(merged_data, 5)
`,

"2": `Question 2: Exploring and Preparing Weather Data
-----------------------------------------------------
weather <- read.csv("weather.csv")
weather$Date <- as.Date(weather$Date, "%Y-%m-%d")
str(weather)

summary(weather$Temperature)
summary(weather$Humidity)

hist(weather$Temperature)
hist(weather$Humidity)
boxplot(weather$Temperature)
boxplot(weather$Humidity)

weather <- subset(weather, WindSpeed <= 50)
weather$ComfortIndex <- weather$Temperature - (weather$Humidity / 2)
weather_filtered <- subset(weather, Date > "2023-01-01")
`,

"3": `Question 3: Integrated Data Workflow
-----------------------------------------
library(readxl)
library(dplyr)

demographics <- read_excel("customers.xlsx", sheet="demographics")
purchases <- read_excel("customers.xlsx", sheet="purchases")
merged_data <- merge(demographics, purchases, by="ID")
str(merged_data)

mean_age <- mean(merged_data$Age, na.rm=TRUE)
median_age <- median(merged_data$Age, na.rm=TRUE)
mean_amount <- mean(merged_data$Amount, na.rm=TRUE)
median_amount <- median(merged_data$Amount, na.rm=TRUE)

plot(merged_data$Age, merged_data$Amount)

merged_data$Gender <- as.factor(merged_data$Gender)
merged_data$Amount[is.na(merged_data$Amount)] <- mean(merged_data$Amount, na.rm=TRUE)
merged_data$Date <- as.Date(merged_data$Date)
merged_data <- subset(merged_data, Date >= "2024-01-01")

total_by_location <- merged_data %>% group_by(Location) %>% summarise(TotalAmount = sum(Amount))
print(total_by_location)
`,

"4": `Question 4: Predictive Models in R
---------------------------------------
library(caret)
library(e1071)
library(rpart)
library(randomForest)

data <- read.csv("customers.csv")
str(data)
summary(data)

set.seed(123)
trainIndex <- createDataPartition(data$Purchase, p=0.7, list=FALSE)
trainData <- data[trainIndex,]
testData <- data[-trainIndex,]

model_dt <- rpart(Purchase ~ ., data=trainData, method="class")
pred_dt <- predict(model_dt, testData, type="class")

trainData$Purchase <- as.factor(trainData$Purchase)
testData$Purchase <- as.factor(testData$Purchase)

model_rf <- randomForest(Purchase ~ ., data=trainData)
pred_rf <- predict(model_rf, testData)

confusionMatrix(pred_dt, testData$Purchase)
confusionMatrix(pred_rf, testData$Purchase)
`,

"5": `Question 5: Flower Clustering
----------------------------------
library(ggplot2)
library(cluster)
library(dplyr)

data(iris)
iris_features <- iris[,1:4]
iris_scaled <- scale(iris_features)

set.seed(123)
kmeans_result <- kmeans(iris_scaled, centers=3)
iris$Cluster <- as.factor(kmeans_result$cluster)

iris_pca <- prcomp(iris_scaled)
iris_pca_df <- data.frame(iris_pca$x[,1:2], Cluster=iris$Cluster, Species=iris$Species)

ggplot(iris_pca_df, aes(PC1,PC2,color=Cluster,shape=Species)) + geom_point(size=3)

table(Cluster=iris$Cluster, Species=iris$Species)
`,

"6": `Question 6: Ensemble Modeling
----------------------------------
library(caret)
library(randomForest)
library(rpart)
library(pROC)

df <- read.csv("synthetic_dataset.csv")
df$Department <- as.factor(df$Department)
df$Experience_Level <- as.factor(df$Experience_Level)
df$Target <- as.factor(df$Target)

set.seed(123)
trainIndex <- createDataPartition(df$Target, p=0.7, list=FALSE)
trainData <- df[trainIndex,]
testData <- df[-trainIndex,]

model_logit <- glm(Target ~ ., data=trainData, family="binomial")
pred_logit <- predict(model_logit, testData, type="response")
pred_logit_class <- ifelse(pred_logit > 0.5, "1","0")

model_tree <- rpart(Target ~ ., data=trainData)
pred_tree <- predict(model_tree, testData, type="class")

model_rf <- randomForest(Target ~ ., data=trainData, ntree=100)
pred_rf <- predict(model_rf, testData)

logit_acc <- mean(pred_logit_class == testData$Target)
tree_acc <- mean(pred_tree == testData$Target)
rf_acc <- mean(pred_rf == testData$Target)
`,

"7": `Question 7: Bank Customer Segmentation
-------------------------------------------
data <- read.csv("bank_customers-1.csv")
data_num <- data[, sapply(data, is.numeric)]
data_num <- data_num[,-1]
scaled_data <- scale(data_num)

pca_result <- prcomp(scaled_data)
pca_data <- data.frame(pca_result$x[,1:2])

set.seed(123)
kmeans_result <- kmeans(pca_data, centers=3)
pca_data$Cluster <- as.factor(kmeans_result$cluster)

library(ggplot2)
ggplot(pca_data, aes(PC1,PC2,color=Cluster)) + geom_point(size=3)

aggregate(data_num, by=list(Cluster=kmeans_result$cluster), mean)
`,

"8": `Question 8: Fitness Data Analysis
---------------------------------------
fitness_data <- read.csv("dailyActivity_merged1.csv")
fitness_data$ActivityDate <- as.Date(fitness_data$ActivityDate, "%m/%d/%Y")
str(fitness_data)

hist(fitness_data$TotalSteps)
hist(fitness_data$Calories)
boxplot(fitness_data$TotalSteps)
boxplot(fitness_data$Calories)

filtered_data <- subset(fitness_data, TotalSteps >= 1000)
filtered_data$ActivityScore <- (filtered_data$TotalSteps / 1000) + (filtered_data$Calories / 200)
head(filtered_data)
`
};

// Determine number from URL
const id = window.location.pathname.replace("/", "") || "1";

document.getElementById("content").innerHTML =
  "<pre>" + (data[id] || "Not Found") + "</pre>";

</script>

</body>
</html>
